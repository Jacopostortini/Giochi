{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/node_modules/cache-loader/dist/cjs.js??ref--0-0!/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/src/components/gamePhaseComponents/MapManager.vue?vue&type=script&lang=js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/src/components/gamePhaseComponents/MapManager.vue","mtime":1613907400148},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/node_modules/cache-loader/dist/cjs.js","mtime":1612540687717},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/node_modules/babel-loader/lib/index.js","mtime":1612540687689},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/node_modules/cache-loader/dist/cjs.js","mtime":1612540687717},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/node_modules/vue-loader-v16/dist/index.js","mtime":1612540688641}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICogYXMgUElYSSBmcm9tICJwaXhpLmpzIjsKaW1wb3J0IHsgZ2V0Q29udGFpbmVyRnJvbVBhdGhPYmplY3QsIGdldENvbnRhaW5lckZyb21TdGF0aW9ucywga2V5UHJlc3NlZCwgbWFwLCBtb3VzZVdoZWVsUmVkdWN0aW9uRmFjdG9yLCBwYXRoVGlsZXNldEhlaWdodCwgcGF0aFRpbGVzZXRXaWR0aCwgdGlsZVNpemUsIHpvb21GdW5jdGlvbkJhc2UgfSBmcm9tICIuLi8uLi9jb25zdGFudHMvbWFwQ29uc3RhbnRzIjsKaW1wb3J0IHN0YXRpb25zIGZyb20gIi4uLy4uL2NvbnN0YW50cy9zdGF0aW9ucyI7CmltcG9ydCB7IG9uTW91bnRlZCwgY29tcHV0ZWQsIHJlZiB9IGZyb20gInZ1ZSI7CmltcG9ydCBwYXRoVGlsZXNldEltYWdlIGZyb20gIi4uLy4uL2Fzc2V0cy9wYXRodGlsZXNldC5wbmciOwppbXBvcnQgbGlua3MgZnJvbSAiLi4vLi4vY29uc3RhbnRzL2xpbmtzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNYXBNYW5hZ2VyIiwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoKSB7CiAgICB2YXIgZGVsdGFZID0gcmVmKDApOwogICAgdmFyIGRyYWdnaW5nID0gcmVmKGZhbHNlKTsKICAgIHZhciBzY2FsZSA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE1hdGgucG93KHpvb21GdW5jdGlvbkJhc2UsIGRlbHRhWS52YWx1ZSAvIG1vdXNlV2hlZWxSZWR1Y3Rpb25GYWN0b3IpOwogICAgfSk7CiAgICB2YXIgYXBwID0gbmV3IFBJWEkuQXBwbGljYXRpb24oewogICAgICB3aWR0aDogdGlsZVNpemUgKiBtYXAud2lkdGgsCiAgICAgIGhlaWdodDogdGlsZVNpemUgKiBtYXAuaGVpZ2h0LAogICAgICB0cmFuc3BhcmVudDogdHJ1ZSwKICAgICAgYW50aWFsaWFzOiBmYWxzZQogICAgfSk7CiAgICBQSVhJLnNldHRpbmdzLlJPVU5EX1BJWEVMUyA9IHRydWU7CiAgICBhcHAubG9hZGVyLmFkZCgicGF0aFRpbGVzZXQiLCBwYXRoVGlsZXNldEltYWdlKSAvLy5hZGQoImJhY2tncm91bmRUaWxlc2V0IiwgInRpbGVzZXQucG5nIikKICAgIC5sb2FkKGZ1bmN0aW9uIChsb2FkZXIsIHJlc291cmNlcykgewogICAgICAvL2Nyb3AgdGlsZXNldHMgdG8gZ2V0IHRpbGVzIHRleHR1cmVzCiAgICAgIHZhciBwYXRoVGV4dHVyZXMgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aFRpbGVzZXRXaWR0aCAqIHBhdGhUaWxlc2V0SGVpZ2h0OyBpKyspIHsKICAgICAgICB2YXIgeCA9IGkgJSBwYXRoVGlsZXNldFdpZHRoOwogICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihpIC8gcGF0aFRpbGVzZXRXaWR0aCk7CiAgICAgICAgcGF0aFRleHR1cmVzW2ldID0gbmV3IFBJWEkuVGV4dHVyZShyZXNvdXJjZXMucGF0aFRpbGVzZXQudGV4dHVyZSwgbmV3IFBJWEkuUmVjdGFuZ2xlKHggKiB0aWxlU2l6ZSwgeSAqIHRpbGVTaXplLCB0aWxlU2l6ZSwgdGlsZVNpemUpKTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGxpbmtzLmxlbmd0aDsgX2krKykgewogICAgICAgIGFwcC5zdGFnZS5hZGRDaGlsZChnZXRDb250YWluZXJGcm9tUGF0aE9iamVjdChsaW5rc1tfaV0sIHN0YXRpb25zLCB0aWxlU2l6ZSwgcGF0aFRleHR1cmVzKSk7CiAgICAgIH0KCiAgICAgIGFwcC5zdGFnZS5hZGRDaGlsZChnZXRDb250YWluZXJGcm9tU3RhdGlvbnMoc3RhdGlvbnMsIHRpbGVTaXplLCBwYXRoVGV4dHVyZXMpKTsKICAgIH0pOwogICAgYXBwLmxvYWRlci5vbkVycm9yLmFkZChmdW5jdGlvbiAoZSkgewogICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgfSk7CgogICAgZnVuY3Rpb24gbW91c2VEb3duKCkgewogICAgICBkcmFnZ2luZy52YWx1ZSA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gbW91c2VNb3ZlKGV2ZW50KSB7CiAgICAgIGlmIChkcmFnZ2luZy52YWx1ZSkgewogICAgICAgIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLnN0eWxlLmN1cnNvciA9ICJtb3ZlIjsKICAgICAgICBldmVudC50YXJnZXQucGFyZW50Tm9kZS5zY3JvbGxMZWZ0IC09IGV2ZW50Lm1vdmVtZW50WDsKICAgICAgICBldmVudC50YXJnZXQucGFyZW50Tm9kZS5zY3JvbGxUb3AgLT0gZXZlbnQubW92ZW1lbnRZOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gbW91c2VVcChldmVudCkgewogICAgICBkcmFnZ2luZy52YWx1ZSA9IGZhbHNlOwogICAgICBldmVudC50YXJnZXQucGFyZW50Tm9kZS5zdHlsZS5jdXJzb3IgPSAiYXV0byI7CiAgICB9CgogICAgZnVuY3Rpb24gem9vbShldmVudCkgewogICAgICB2YXIgem9vbUZhY3RvciA9IDE7CgogICAgICBpZiAoZGVsdGFZLnZhbHVlICsgZXZlbnQuZGVsdGFZIDwgMCkgewogICAgICAgIGRlbHRhWS52YWx1ZSA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGVsdGFZLnZhbHVlICs9IGV2ZW50LmRlbHRhWTsKICAgICAgICB6b29tRmFjdG9yID0gTWF0aC5wb3coem9vbUZ1bmN0aW9uQmFzZSwgZXZlbnQuZGVsdGFZIC8gbW91c2VXaGVlbFJlZHVjdGlvbkZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHZhciBwYW5lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5tYXAtbWFuYWdlcl9fbWFpbi1wYW5lbCIpOwogICAgICB2YXIgc0wgPSBldmVudC5vZmZzZXRYICogKHpvb21GYWN0b3IgLSAxKSArIHBhbmVsLnNjcm9sbExlZnQgKiB6b29tRmFjdG9yOwogICAgICB2YXIgc1QgPSBldmVudC5vZmZzZXRZICogKHpvb21GYWN0b3IgLSAxKSArIHBhbmVsLnNjcm9sbFRvcCAqIHpvb21GYWN0b3I7CiAgICAgIHBhbmVsLnNjcm9sbExlZnQgPSBNYXRoLnJvdW5kKHNMKTsKICAgICAgcGFuZWwuc2Nyb2xsVG9wID0gTWF0aC5yb3VuZChzVCk7CiAgICB9CgogICAgb25Nb3VudGVkKGZ1bmN0aW9uICgpIHsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1hcC1tYW5hZ2VyX19tYWluLXBhbmVsIikuYXBwZW5kQ2hpbGQoYXBwLnZpZXcpOwogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIGtleVByZXNzZWQpOwogICAgfSk7CiAgICByZXR1cm4gewogICAgICBzY2FsZTogc2NhbGUsCiAgICAgIG1vdXNlRG93bjogbW91c2VEb3duLAogICAgICBtb3VzZU1vdmU6IG1vdXNlTW92ZSwKICAgICAgbW91c2VVcDogbW91c2VVcCwKICAgICAgem9vbTogem9vbQogICAgfTsKICB9Cn07"},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/unseen.papero.tk/src/components/gamePhaseComponents/MapManager.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"map-manager__main-panel\"\r\n       id=\"map-manager__main-panel\"\r\n       @mousedown=\"mouseDown\"\r\n       @mousemove=\"mouseMove\"\r\n       @mouseup=\"mouseUp\"></div>\r\n</template>\r\n\r\n<script>\r\nimport *  as PIXI from \"pixi.js\";\r\nimport {\r\n  getContainerFromPathObject,\r\n  getContainerFromStations,\r\n  keyPressed,\r\n  map,\r\n  mouseWheelReductionFactor,\r\n  pathTilesetHeight,\r\n  pathTilesetWidth,\r\n  tileSize,\r\n  zoomFunctionBase\r\n} from \"../../constants/mapConstants\";\r\nimport stations from \"../../constants/stations\";\r\nimport {onMounted, computed, ref} from \"vue\";\r\nimport pathTilesetImage from \"../../assets/pathtileset.png\";\r\nimport links from \"../../constants/links\";\r\nexport default {\r\n  name: \"MapManager\",\r\n  setup() {\r\n    const deltaY = ref(0);\r\n    const dragging = ref(false);\r\n    const scale = computed(function (){\r\n      return Math.pow(zoomFunctionBase, deltaY.value/mouseWheelReductionFactor);\r\n    });\r\n\r\n    const app = new PIXI.Application({\r\n      width: tileSize * map.width,\r\n      height: tileSize * map.height,\r\n      transparent: true,\r\n      antialias: false\r\n    });\r\n\r\n    PIXI.settings.ROUND_PIXELS = true;\r\n\r\n    app.loader\r\n        .add(\"pathTileset\", pathTilesetImage)\r\n        //.add(\"backgroundTileset\", \"tileset.png\")\r\n        .load((loader, resources) => {\r\n\r\n          //crop tilesets to get tiles textures\r\n\r\n          let pathTextures = [];\r\n          for (let i = 0; i < pathTilesetWidth * pathTilesetHeight; i++) {\r\n            let x = i % pathTilesetWidth;\r\n            let y = Math.floor(i / pathTilesetWidth);\r\n            pathTextures[i] = new PIXI.Texture(\r\n                resources.pathTileset.texture,\r\n                new PIXI.Rectangle(x * tileSize, y * tileSize, tileSize, tileSize)\r\n            );\r\n          }\r\n\r\n          for (let i = 0; i < links.length; i++){\r\n            app.stage.addChild(getContainerFromPathObject(links[i], stations, tileSize, pathTextures));\r\n          }\r\n          app.stage.addChild(getContainerFromStations(stations, tileSize, pathTextures));\r\n\r\n        });\r\n\r\n\r\n    app.loader.onError.add((e)=>{\r\n      console.error(e);\r\n    });\r\n\r\n    function mouseDown() {\r\n      dragging.value = true;\r\n    }\r\n\r\n    function mouseMove(event) {\r\n      if(dragging.value){\r\n        event.target.parentNode.style.cursor = \"move\";\r\n        event.target.parentNode.scrollLeft -= event.movementX;\r\n        event.target.parentNode.scrollTop -= event.movementY;\r\n      }\r\n    }\r\n\r\n    function mouseUp(event) {\r\n      dragging.value = false;\r\n      event.target.parentNode.style.cursor = \"auto\";\r\n    }\r\n\r\n    function zoom(event) {\r\n      let zoomFactor = 1;\r\n      if(deltaY.value+event.deltaY<0){\r\n        deltaY.value = 0;\r\n      } else {\r\n        deltaY.value += event.deltaY;\r\n        zoomFactor = Math.pow(zoomFunctionBase, event.deltaY/mouseWheelReductionFactor);\r\n      }\r\n      let panel = document.querySelector(\".map-manager__main-panel\");\r\n      let sL = event.offsetX*(zoomFactor-1)+panel.scrollLeft*zoomFactor;\r\n      let sT = event.offsetY*(zoomFactor-1)+panel.scrollTop*zoomFactor;\r\n      panel.scrollLeft = Math.round(sL);\r\n      panel.scrollTop = Math.round(sT);\r\n    }\r\n\r\n    onMounted(() => {\r\n      document.getElementById(\"map-manager__main-panel\").appendChild(app.view);\r\n      window.addEventListener(\"keydown\", keyPressed);\r\n    });\r\n\r\n    return{\r\n      scale,\r\n      mouseDown,\r\n      mouseMove,\r\n      mouseUp,\r\n      zoom\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n.map-manager__main-panel{\r\n  overflow: hidden;\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 0 20px 20px 0;\r\n}\r\n</style>"],"sourceRoot":""}]}